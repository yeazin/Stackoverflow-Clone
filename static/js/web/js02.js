"use strict";var auth={"currentPage":null,"pages":{"SignUp":1,"Login":2,"AddLogin":3,"Password":4},"getSsrc":function(e){var t=$('#login-form input[name="ssrc"]'),n=void 0;return t&&1===t.length&&(n=t.val()),n||(n=e),n},"init":function(e){auth.currentPage=e;var t=[],n=[],a=[],o=[],r=null,i=null,s=null,c=null,u=function(e,t){var n=e.closest(".js-auth-item");n.addClass("has-error"),n.find(".js-alert-icon").removeClass("d-none"),n.find(".js-error-message").removeClass("d-none").append(t)},l=function(e){var t=e.closest(".js-auth-item");t.removeClass("has-error"),t.find(".js-alert-icon").addClass("d-none"),t.find(".js-error-message").addClass("d-none").empty()};if($("#openid-buttons").on("click","[data-provider]",function(t){e===auth.pages.Login&&StackExchange.using("gps",function(){StackExchange.gps.track("login.start",{"tid":StackExchange.options.user.tid},!0)});var n=$(this).data("provider");if(n){var a=!1;e===auth.pages.SignUp&&(StackExchange.using("gps",function(){StackExchange.gps.track("signup.start",{"openid_provider":n,"location":auth.getSsrc("signup_page"),"tid":StackExchange.options.user.tid},!0)}),a=!0),auth.signin($(this),t,a)}}),e===auth.pages.SignUp){var d=$("#se-login-fields");$(d).on("keyup","input[name=password],input[name=display-name],input[name=email]",function(e){var t=$(e.target);if(!t.data("entered")){var n="signup."+t.attr("name").replace("display-","")+".entered";StackExchange.using("gps",function(){StackExchange.gps.track(n,{},!0)}),t.data("entered",!0),StackExchange.options.mustTrackSignupStartForResearchRecruitment&&!d.data("entered")&&($.ajax("/urr/signup-start"),d.data("entered",!0))}}),$("#se-login-fields").on("click","#submit-button",function(){StackExchange.using("gps",function(){StackExchange.gps.track("signup.se.click",{},!0)})}),$(".js-terms").on("click","a[name=privacy],a[name=tos]",function(e){var t=$(e.target),n="signup."+t.attr("name")+".click";StackExchange.using("gps",function(){StackExchange.gps.track(n,{},!0)})}),$(".js-redirects").on("click","a[name=login],a[name=talent]",function(e){var t=$(e.target),n="signup."+t.attr("name")+"_redirect";StackExchange.using("gps",function(){StackExchange.gps.track(n,{},!0)})})}var f=$('<p class="s-input-message fc-red-500"></p>').text("Caps lock is on"),p=$(".js-password"),g=!1;p.keypress(function(e){var t=String.fromCharCode(e.which),n=/[a-z]/i.test(t);if(n){var a=t==t.toUpperCase();g=a&&!e.shiftKey}var o=document.msCapsLockWarningOff===!1,r=o;g&&!r?p.after(f):f.remove()}),p.find("input").blur(function(){f.remove()});var h=!1,m=!1;$("#login-form input").blur(function(t){e===auth.pages.SignUp&&(""==$(t.target).val()||h||(StackExchange.gps.track("signup.start",{"openid_provider":"Stack Exchange","location":auth.getSsrc("signup_page"),"tid":StackExchange.options.user.tid},!0),h=!0)),e===auth.pages.Login&&(""==$(t.target).val()||m||(StackExchange.gps.track("login.start",{"tid":StackExchange.options.user.tid},!0),m=!0))}),$("#login-form input[type='text'], #login-form input[type='password'], #login-form input[type='email']").keypress(function(t){return 13===t.which?($("#submit-button").is(":hidden")||e===auth.pages.AddLogin?$("#login-form").submit():$("#login-form #submit-button").click(),t.preventDefault(),!1):void 0});var v=function(e,t){if(e.length>0){if(null!=t){for(var n=!0,a=0;a<e.length;a++)if(e[a].message==t.message){n=!1;break}e[0].changed=n}return e[0]}},b=function(e){null!=e&&e.changed&&u(e.attachTo,e.message)},k=function(){b(r),b(i),b(c),b(s)},S=function(){t=[],n=[],a=[],o=[],r=null,i=null,s=null,c=null,$(".js-auth-item").removeClass("has-error"),$(".js-alert-icon").addClass("d-none"),$(".js-error-message").addClass("d-none").empty()},y=function(e,t,n){for(var a="all"===t,o=0;o<e.length&&(e[o].id!=t&&!a||(e.splice(o,1),a));o++);n&&l(n)},w=StackExchange.Auth.addOrUpdateError,x=function(t){var a=$("input[name = 'password']"),o=0===$.trim(a.val()).length;if(o&&!t?w(n,{"id":"pw-empty","index":0,"attachTo":a,"message":"Password cannot be empty."}):y(n,"pw-empty",a),e===auth.pages.SignUp||e===auth.pages.Password){StackExchange.Auth.passwordStrengthValidation(a,n,y);var r=$.trim(a.val()),i=$('input[name="password2"]');if(i.length){var s=$.trim(i.val());0===s.length?w(n,{"id":"pw-empty2","index":3,"attachTo":i,"message":"Password confirmation cannot be empty."}):y(n,"pw-empty2",i),s.length>0&&r!==s?w(n,{"id":"pw-match","index":4,"attachTo":i,"message":"The passwords do not match."}):y(n,"pw-match",i)}if(StackExchange.settings.accounts.currentPasswordRequiredForChangingStackIdPassword){var c=$('input[name="currentpassword"]');if(c.length){var u=$.trim(c.val());0===u.length?w(n,{"id":"curpw-empty","index":0,"attachTo":c,"message":"Current password cannot be empty."}):y(n,"curpw-empty",c)}}}},E=function(){var e=$("input[name='email']"),n=0===$.trim(e.val()).length;n?w(t,{"id":"em-empty","index":0,"attachTo":e,"message":"Email cannot be empty."}):y(t,"em-empty",e)},j=function(){var e=$("#no-captcha-here iframe").length>0,t=$(".js-catpcha-error-container");if(e){var n=grecaptcha.getResponse().length>0;n?y(o,"cp",t):w(o,{"id":"cp","index":0,"attachTo":t,"message":"CAPTCHA response required."})}},T=function(){var e=$.trim($("input[name='email']").val()).toUpperCase(),t=$("input[name='display-name']"),n=$.trim(t.val()).toUpperCase();e===n&&""!=e?w(a,{"id":"nm","index":0,"attachTo":t,"message":"Name and email address must be different. If you don't want to enter a name, just leave it blank.","faileType":"name_email_same"}):y(a,"nm",t)},O=function(){return x(),e===auth.pages.SignUp&&(T(),j()),e!=auth.pages.Password&&E(),r=v(t,r),i=v(n,i),s=v(a,s),c=v(o,c),null==r&&null==i&&null==s&&null==c},C=!0;$("#login-form #submit-button").click(function(n){var a={"isSignup":e===auth.pages.SignUp,"isLogin":e===auth.pages.Login,"isPassword":e===auth.pages.Password,"isAddLogin":e===auth.pages.AddLogin};return S(),$("#login-form input").each(function(e,t){var n=$(t).attr("name");n&&(n=n.replace(/(\W|_)/gi,""),a[n]=$(t).val())}),$.ajax({"url":"/users/login-or-signup/validation/track","data":a,"type":"POST","complete":function(){var n=O();return C&&($("#login-form input").blur(function(){if(O(),e===auth.pages.SignUp){var n=$("#login-form input[name='email']"),a=$.trim(n.val());y(t,"em-ajax"),$.ajax({"type":"POST","url":"/users/signup/email/validate","data":{"email":a,"fkey":StackExchange.options.user.fkey},"success":function(a){e!==auth.pages.AddLogin&&(a.IsValid?r=null:(w(t,{"id":"em-ajax","index":1,"attachTo":n,"message":a.ErrorMessage}),r=v(t,r)))},"complete":function(){k()}})}else k()}),C=!1),n?($("#login-form").submit(),void 0):(k(),void 0)}}),n.preventDefault(),!1}),$("#se-pw-reset").submit(function(e){S();var t=O();return t||(k(),e.preventDefault()),t})},"removeAllErrors":function(){},"signin":function(e,t,n){function a(e,t){var n="users_login";auth.currentPage===auth.pages.SignUp&&(n="signup_page",t||StackExchange.using("gps",function(){StackExchange.gps.track("signup.start",{"openid_provider":e,"location":auth.getSsrc(n),"tid":StackExchange.options.user.tid},!0)}),e&&StackExchange.using("gps",function(){StackExchange.gps.track("signup.openid.click",{"openid_provider":e,"location":n},!0)})),e&&StackExchange.using("gps",function(){StackExchange.gps.track("openid.click",{"openid_provider":e,"location":n},!0)})}function o(e){var t={"name":e.data("provider")};return e.data("oauthserver")&&(t.oauth_server=e.data("oauthserver")),e.data("oauthversion")&&(t.oauth_version=e.attr("data-oauthversion")),t}var r=e.data?o(e):e;if(r){if("stack_exchange"===r.name)return a("Stack Exchange",n),void 0;a(r.name.replace(/_/g," "),n),"2.0"===r.oauth_version&&this.setOAuthInfo(r.oauth_version,r.oauth_server),$("#login-form").submit()}},"setOAuthInfo":function(e,t){$("#oauth_version").val(e),$("#oauth_server").val(t)}};